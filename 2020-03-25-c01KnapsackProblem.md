---
title: 01背包问题
date: 2020-03-25 16:57:07
categories: 
    - 算法
tags: 
    - 背包问题
---

# 问题描述

给定 5块石头和一个承重为 15的背包，石头i的重量是 weight，其价值为 value 。

# 怎么装使得背包里物品的总价值最大

## 代码

```c++
#include<iostream>
using namespace std;
int main(){
	int weight[6]={0,5,4,7,2,6};//0表示占位，从1开始
	int value[6]={0,12,3,10,3,6};
	int a[6][16]={0};
	for(int i=1;i<=5;i++){
		for(int j=1;j<=15;j++){
			if(weight[i]>j){
				a[i][j]=a[i-1][j];
			}
			else {
				a[i][j]=max(a[i-1][j],a[i-1][j-weight[i]]+value[i]);
			}
		}
	}
    cout<<"最大价值为"<<a[5][15];
	return 0;
} 
```



## 解释

我们有五个石头，其重量和价值如下

|      | 1    | 2    | 3    | 4    | 5    |
| ---- | ---- | ---- | ---- | ---- | ---- |
| 重量 | 5    | 4    | 7    | 2    | 6    |
| 价值 | 12   | 3    | 10   | 3    | 6    |

我们设定一个数组a，用它来记录背包容量从0-15时背包内可获得的物品最大价值.

其中

行表示物品的编号

列表示背包的可承受重量

第0行置为0，用来做第一个物品的基础计算值

第0列置为0，用来表示背包承重量为0时，物品最大价值为0

|      | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    |
| 1    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 2    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 3    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 4    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 5    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |

这样我们从第一个石头算起，其重量为5，价值为12

背包承重量依次增加，直到背包承重量为5时，方可放入第一个石头，其物品最大价值为12。

由于此时只看第一个石头，故后面均为12。

|      | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    |
| 1    | 0    | 0    | 0    | 0    | 0    | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   |
| 2    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 3    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 4    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |
| 5    | 0    |      |      |      |      |      |      |      |      |      |      |      |      |      |      |      |

接着我们看第二个石头，其重量为4，价值为3

背包承重量从0增长，当背包承重量增长为4时可以放下.

当背包重量为5时，我们比较不放入和放入第二块石头的情况。

如果不放入那么价值就是和上一块保持一致，即总价值a{i}{j}=a{i-1}{j}。//markdown语法问题，用{代替[

如果放入那么就要留有足够的空间放入第二块石头，则此时背包剩余容量为j-weight{i}，背包剩余价值为a{i-1}{j-weight{i}}，总价值a{i}{j}=a{i-1}{j-weight{i}}+value{i}。

比较这两种情况取最大值填入表中。

以此类推第三块石头，第四块石头，第五块石头得到下表。

|      | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   | 12   | 13   | 14   | 15   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    |
| 1    | 0    | 0    | 0    | 0    | 0    | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   | 12   |
| 2    | 0    | 0    | 0    | 0    | 3    | 12   | 12   | 12   | 12   | 15   | 15   | 15   | 15   | 15   | 15   | 15   |
| 3    | 0    | 0    | 0    | 0    | 3    | 12   | 12   | 12   | 12   | 15   | 15   | 15   | 22   | 22   | 22   | 22   |
| 4    | 0    | 0    | 3    | 3    | 3    | 12   | 12   | 15   | 15   | 15   | 15   | 18   | 22   | 22   | 25   | 25   |
| 5    | 0    | 0    | 3    | 3    | 3    | 12   | 12   | 15   | 15   | 15   | 15   | 18   | 22   | 22   | 25   | 25   |

则最大价值就为a{5}{15},即25。

# 应该装哪几块石头

## 代码

```c++
void stone(){
	int flag=15;
	int isstone[6]={0};
	for(int i=5;i>=1;i--){
		if(a[i][flag]==a[i-1][flag])isstone[i]=0;
		else{
			flag-=weight[i];
			isstone[i]=1;
		}
		cout<<"为1的是放进去的石头"<<isstone[i]<<" "; 
	}
}
```

## 解释

从最后一个石头开始判断，flag记录当前背包没有确定石头的承重量，初始值为背包承重量。

如果a{i}{j}和a{i-1}{j}相等，说明第i块石头没有影响背包的价值变动，所以没有放进去，继续判断前一个石头。

如果a{i}{j}和a{i-1}{j}不相等，说明第i块石头影响了背包价值变动，所以放了进去，flag减去该石头的重量。在已经减去上一个已判断石头重量的基础上，继续判断前一个石头是否放进背包。
---
title: 应用层相关知识点
date: 2020-03-15 15:00:29
categories: 
    - 计算机网络
tags: 
    - applicationLayer
---

# 概述

- 用户对用户
- 任务：提供系统与用户的接口
- 功能：文件传输、访问和管理、电子邮件服务
- 协议：FTP、SMTP、POP3、HTTP

# 网络应用模型

| 模型                   | 功能                                                         |
| ---------------------- | ------------------------------------------------------------ |
| C/S（客户/服务器模型） | 各计算机地位不平等，网络管理工作有少数服务器承担，可扩展性不佳。 |
| P2P                    | 计算机任务可以分配到个节点上，系统可扩展性好，网络更加健壮。 |

# DNS系统

## 层次域名空间

采用了层次树状结构的命名法，即域名。

结构：。。。.二级域名.一级域名.顶级域名

| 顶级域名             | 内容                                                         |
| -------------------- | ------------------------------------------------------------ |
| 国家顶级域名         | .cn中国 .us美国 .uk英国                                      |
| 通用顶级域名         | .com公司和企业 .net网络服务机构 .org非营利向组织 .edu美国专用的教育机构 .gov美国专用的政府部门 .mil美国专用的军事部门 .int国际组织 |
| 基础结构顶级域名arpa | 用于反向域名解析，又称反向域名                               |

## 域名服务器

| 域名服务器                       |                                                              |
| -------------------------------- | ------------------------------------------------------------ |
| 根域名服务器                     | 是最重要的域名服务器，所有根域名服务器都知道顶级域名服务器的域名和IP地址，本地域名服务器只要无法解析，就求助于根域名服务器，告诉本地域名服务器上一级域名服务器的地址。 |
| 顶级域名服务器                   | 管辖在该顶级域名服务器注册的所有二级服务器，当收到dns请求时，给出结果或者下一步请求的域名服务器的地址。 |
| 权限域名服务器（授权域名服务器） | 负责一个区的域名服务，给出结果或下一步应当访问的权限域名服务器。 |
| 本地域名服务器                   | 非常重要，主机发送dns请求时就会将查询请求报文发送给本地域名服务器。 |

## 域名解析过程

| 分类     | 解析过程                                                     |
| -------- | ------------------------------------------------------------ |
| 迭代查询 | 根域名服务器收到查询请求，要么给出查询结果，要么告诉本地域名服务器下一步向哪个域名服务器进行查询。 |
| 递归查询 | 本地域名服务器只请求一次，后面几次都是在其他几个域名服务器之间进行的。 |

# FTP文件传输

工作原理

- TCP可靠传输，C/S模型
- 打开21端口
- 等待客户进程发出请求
- 启动从属程序处理请求，从属程序可能会创造一些新的进程
- 主程序等待其他客户进程发出请求
- 主程序与从属程序并发进行

| 连接分类 | 端口 | 功能                                                       |
| -------- | ---- | ---------------------------------------------------------- |
| 控制连接 | 21   | 客户端通过这个连接发送各种操作请求                         |
| 数据连接 | 20   | 在文件传输请求后创建数据传送和接收进程，并在传输完成后关闭 |

# 电子邮件

## 组成

- 用户代理
  - 用户与电子邮件系统的接口，如outlook
- 邮件服务器
  - 发送接收邮件，报告邮件传输情况
- 电子邮件使用协议
  - SMTP,POP3

## 发送接收过程

- 发件人调用用户代理来编辑要发送的邮件
- 发件人通过用户代理把邮件传送给发送端邮件服务器
  - 客户端建立TCP连接服务器
  - 服务器发送身份信息，确认连接已经建立
  - 客户端发送身份信息，服务器确认收到
  - 客户端发送邮件接收者地址，服务器确认收到
  - 客户端发送邮件发送者地址，服务器确认收到
  - 客户端请求发送邮件内容，服务器确认准备好
  - 客户端发送邮件内容，最有以一个仅包含.的行结束，服务器发回数据已收到的确认
- 邮件服务器将邮件放入邮件缓存队列，等待发送
- 发送端的SMTP进程发现邮件缓存中有邮件，就向接收端SMTP进程建立TCP连接
- TCP建立后开始传输邮件，完成后TCP关闭连接
- 接收端SMTP将邮件放入收件人邮箱
- 收件人调用用户代理，使用POP3(IMAP)从邮箱中取回
  - 客户端建立TCP连接至服务器
  - 服务器发送身份信息，确认链接已经建立
  - 客户端发送USER命令+用户名，服务器确认收到
  - 客户端发送PASS命令+用户密码，服务器确认收到
  - 客户端发送LIST命令，服务器返回当前邮件箱的邮件个数列表
  - 客户端发送RETR命令，服务器发回相应的邮件内容
  - 客户端接受完邮件后，选择是否发送DELE命令+邮件编号，通知服务器从邮箱中删除相应的邮件

## 格式

- To:收件人邮箱地址
- Subject：邮件主题
- 收件人邮箱名@邮箱所在主机域名
- MIME
  - SMTP只限于传送一定长度的7为ASCII编
  - MIME意图继续使用目前的RFC 822格式但增加邮件主体的结构，定义传送非ASCII码规则
    - quoted-printable
      - 用=加两个十六进制字符，表示非ASCIII
      - 如，汉字系统两字代码为11000……011，共32位，就表示为=CF=B5=CD=B3
    - base64
      - 共64个值，字母大小写，+ / == =
      - 将24位二进制代码划分四个六位组，转化为对应的base64编码，并以这些字符的二进制ASCII编码发送

## 协议

| 协议                 | 描述                                                         |
| -------------------- | ------------------------------------------------------------ |
| SMTP简单邮件传输协议 | 端口号25，TCP连接，连接建立/邮件发送/连接释放                |
| POP3邮局协议版本3    | 在用户计算机中运行POP客户程序，在ISP服务器中运行POP服务程序，用户从POP服务器读取邮件，POP服务器就将该邮件删去。 |

# WWW万维网

## 概念

- 一个大规模联机式的信息贮藏所
- 用统一资源定位符来标识URL的各种文档，<协议>://<主机>:<端口号>/<路径>

## 流程

- Web用户使用浏览器指定URL与Web服务器建立连接，并发送浏览请求
- Web服务器吧URL转化为文件路径，并返回信息给Web浏览器
- 通信完成，关闭连接

## HTTP超文本传送协议

端口80，是TCP可靠连接

报文：

- 请求报文：客户向服务器发送请求报文
- 响应报文：从服务器到客户的回答
- 内容
  - 开始行，区别请求报文(请求行，方法、目标URL)和响应报文(状态行，版本、状态码)
  - 首部行，说明浏览器，服务器，报文主体的一些信息
  - 实体主体，不一定有
- 方法
  - GET：请求读取由URL所标识的信息
  - HEAD：读取由URL所标识的信息首部
  - POST：给服务器添加信息
  - CONNECT：用于代理服务器
- 工作方式
  - 非持久连接：每个网页元素都需要单独建立一次TCP三次握手
  - 持久连接：发送响应后仍保持这条连接

# 参考文献

天勤计算机网络